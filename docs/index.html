<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Simulators</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        /* Main Menu Styles */
        .main-menu {
            padding: 40px;
            text-align: center;
        }
        
        .main-menu h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .main-menu .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 40px;
        }
        
        .simulator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .simulator-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            padding: 30px;
            text-align: left;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .simulator-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .simulator-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .simulator-card h3 {
            color: #2c3e50;
            font-size: 1.4em;
            margin-bottom: 10px;
        }
        
        .simulator-card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .simulator-card .features {
            list-style: none;
            padding: 0;
        }
        
        .simulator-card .features li {
            color: #555;
            margin-bottom: 5px;
            padding-left: 20px;
            position: relative;
        }
        
        .simulator-card .features li:before {
            content: "‚úì";
            color: #27ae60;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        /* Back button */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 1000;
            display: none;
        }
        
        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }
        
        /* Simulator content areas */
        .simulator-content {
            display: none;
            padding: 20px;
            min-height: 100vh;
        }
        
        .simulator-content.active {
            display: block;
        }
        
        /* GitHub Simulator Styles */
        .github-simulator {
            max-width: 800px;
            margin: 0 auto;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 30px;
        }
        
        .github-simulator h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }
        
        .role-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .role-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .role-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .role-card .role-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .role-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .role-card p {
            color: #666;
            font-size: 14px;
        }
        
        .workflow-container {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .step-info {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
            font-size: 14px;
        }
        
        .current-step {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .platform-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            color: white;
            margin-bottom: 10px;
        }
        
        .platform-badge.github { background: #333; }
        .platform-badge.godot { background: #478cbf; }
        .platform-badge.endless { background: #8b5cf6; }
        .platform-badge.email { background: #16a085; }
        
        .step-title {
            color: #2c3e50;
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        .step-content {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .step-details {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
            font-size: 14px;
            color: #1565c0;
        }
        
        .step-warning {
            background: #ffeaa7;
            border-left: 4px solid #fdcb6e;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
            font-size: 14px;
            color: #d63031;
        }
        
        .choices-grid {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }
        
        .choice-btn {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .choice-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .choice-btn .choice-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .choice-btn .choice-desc {
            font-size: 14px;
            color: #666;
        }
        
        .next-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            float: right;
            transition: all 0.3s ease;
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .complete-btn {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            display: block;
            margin: 20px auto 0;
            transition: all 0.3s ease;
        }
        
        .complete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .state-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .state-display h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .state-item {
            color: #667eea;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        /* Godot Simulator Styles (from the original) */
        .godot-simulator {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 15px;
        }
        
        .godot-container {
            background: white;
            border-radius: 12px;
            padding: 15px;
        }
        
        .godot-simulator h1 {
            color: #2c3e50;
            text-align: center;
            margin: 0 0 8px 0;
            font-size: 1.3em;
        }
        
        .scenario-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 6px 10px;
            margin: 0 0 6px 0;
            border-left: 4px solid #3498db;
        }
        
        .scenario-section h3 {
            margin: 0 0 4px 0;
            font-size: 1em;
        }
        
        .scenario-section p {
            margin: 2px 0;
            font-size: 14px;
        }
        
        .current-step-godot {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 8px;
            padding: 8px 12px;
            margin: 0 0 6px 0;
            border: none;
        }
        
        .current-step-godot h3 {
            margin: 0 0 6px 0;
            font-size: 1em;
        }
        
        .current-step-godot p {
            margin: 4px 0;
            font-size: 14px;
        }
        
        .choices-godot {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin: 8px 0;
        }
        
        .choice-btn-godot {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .choice-btn-godot:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .path-tracker {
            background: #e8f4f8;
            border-radius: 8px;
            padding: 6px 10px;
            margin: 0 0 6px 0;
            border-left: 4px solid #1abc9c;
        }
        
        .path-tracker h4 {
            margin: 0 0 4px 0;
            font-size: 0.9em;
        }
        
        .path-step {
            background: #1abc9c;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            margin: 1px;
            display: inline-block;
        }
        
        .outcome {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border-radius: 8px;
            padding: 8px 12px;
            margin: 6px 0;
        }
        
        .outcome h3 {
            margin: 0 0 4px 0;
            font-size: 1em;
        }
        
        .outcome p {
            margin: 2px 0;
            font-size: 14px;
        }
        
        .reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 8px;
        }
        
        .reset-btn:hover {
            background: #c0392b;
        }
        
        .info-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 6px 8px;
            margin: 4px 0;
            color: #856404;
        }
        
        .info-box h4 {
            margin: 0 0 2px 0;
            font-size: 0.9em;
        }
        
        .info-box p {
            margin: 2px 0;
            font-size: 13px;
        }
        
        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 6px 8px;
            margin: 4px 0;
            color: #155724;
        }
        
        .warning-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 6px 8px;
            margin: 4px 0;
            color: #721c24;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .simulator-grid {
                grid-template-columns: 1fr;
            }
            
            .role-selection {
                grid-template-columns: 1fr;
            }
            
            .main-menu h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" id="backBtn" onclick="showMainMenu()">‚Üê Back to Main Menu</button>
    
    <div class="container">
        <!-- Main Menu -->
        <div id="mainMenu" class="main-menu">
            <h1>üéÆ Workflow Simulators</h1>
            <p class="subtitle">Interactive tools to understand development workflows</p>
            
            <div class="simulator-grid">
                <div class="simulator-card" onclick="showGitHubSimulator()">
                    <div class="icon">üîß</div>
                    <h3>Explorer Program GitHub Workflow</h3>
                    <p>Experience the complete student and teacher workflow for setting up GitHub-based game development projects.</p>
                    <ul class="features">
                        <li>GitHub account creation process</li>
                        <li>Endless Platform integration</li>
                        <li>Software bundle installation</li>
                        <li>Authentication methods (Token vs CLI)</li>
                        <li>Project download and setup</li>
                    </ul>
                </div>
                
                <div class="simulator-card" onclick="showGodotSimulator()">
                    <div class="icon">üéØ</div>
                    <h3>Godot Collaborative Development</h3>
                    <p>Simulate real-time collaboration scenarios in game development with file locking, conflict resolution, and team coordination.</p>
                    <ul class="features">
                        <li>File access and locking system</li>
                        <li>Conflict detection and resolution</li>
                        <li>Team coordination workflows</li>
                        <li>Auto-resolution mechanisms</li>
                        <li>Discussion and decision tools</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- GitHub Simulator -->
        <div id="githubSimulator" class="simulator-content">
            <div class="github-simulator">
                <h2>Explorer Program GitHub Workflow Simulator</h2>
                
                <div id="githubRoleSelection" class="role-selection">
                    <div class="role-card" onclick="startGitHubWorkflow('student')">
                        <div class="role-icon">üë®‚Äçüéì</div>
                        <h3>Student</h3>
                        <p>Complete workflow: Account ‚Üí Platform ‚Üí Bundle ‚Üí Project</p>
                    </div>
                    <div class="role-card" onclick="startGitHubWorkflow('teacher')">
                        <div class="role-icon">üë®‚Äçüè´</div>
                        <h3>Teacher</h3>
                        <p>Repository management and team setup</p>
                    </div>
                </div>
                
                <div id="githubWorkflow" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="githubProgress"></div>
                    </div>
                    <div class="step-info" id="githubStepInfo">Step 1 of 1</div>
                    
                    <div class="workflow-container">
                        <div class="current-step" id="githubCurrentStep">
                            <!-- Step content will be populated by JavaScript -->
                        </div>
                        
                        <div id="githubStateDisplay" style="display: none;" class="state-display">
                            <h4>Current State:</h4>
                            <div id="githubStateContent"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Godot Simulator -->
        <div id="godotSimulator" class="simulator-content">
            <div class="godot-simulator">
                <div class="godot-container">
                    <h1>üéÆ Godot Collaborative Development - Workflow Simulator</h1>
                    
                    <div class="info-box">
                        <h4>üéØ Implementation Note</h4>
                        <p><strong>This simulator demonstrates the MVP implementation:</strong> Universal file handling where all file types (.gd, .tscn, .png, .ogg) are treated equally with simple conflict detection and basic preservation. The Full Feature implementation will add file-type-specific intelligence, visual comparison tools, and advanced collaboration features.</p>
                    </div>
                    
                    <div class="scenario-section">
                        <h3>üìã Current Scenario</h3>
                        <p><strong>Team:</strong> Alice, Bob, and Charlie working on a 2D platformer game</p>
                        <p><strong>Context:</strong> You are <span id="current-user">Bob</span>, and you want to work on <span id="current-file">PlayerController.gd</span></p>
                    </div>
                    
                    <div class="path-tracker">
                        <h4>üõ§Ô∏è Your Path Through the Workflow:</h4>
                        <div id="path-display">
                            <span class="path-step">Started</span>
                        </div>
                    </div>
                    
                    <div id="current-step-container">
                        <div class="current-step-godot">
                            <h3 id="step-title">Step 1: File Access Check</h3>
                            <p id="step-description">The system is checking the status of PlayerController.gd to determine if you can edit it...</p>
                            
                            <div class="info-box">
                                <strong>System Status:</strong> Checking lock status and recent updates...
                            </div>
                            
                            <div class="choices-godot" id="choices-container">
                                <button class="choice-btn-godot" onclick="makeGodotChoice('available')">
                                    üîó File is Available (No lock, no recent updates)
                                </button>
                                <button class="choice-btn-godot" onclick="makeGodotChoice('has-updates')">
                                    üìô File Has Recent Updates (Alice modified it 5 minutes ago)
                                </button>
                                <button class="choice-btn-godot" onclick="makeGodotChoice('locked')">
                                    üîí File is Currently Locked (Charlie is actively editing)
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="outcome-container"></div>
                    
                    <button class="reset-btn" onclick="resetGodotSimulation()" style="display: none;" id="reset-button">
                        üîÑ Start New Simulation
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentView = 'main';
        let githubState = {
            role: '',
            currentStep: 0,
            authMethod: '',
            workflow: []
        };
        
        // GitHub Workflow Data
        const githubWorkflows = {
            student: {
                base: [
                    {
                        title: 'Create GitHub Account',
                        platform: 'github',
                        content: 'You need to manually create a GitHub account at github.com. GitHub prohibits automated account creation.',
                        details: 'Required: valid email, unique username, secure password. You may encounter CAPTCHA, email verification, or username conflicts.'
                    },
                    {
                        title: 'GitHub Account Created',
                        platform: 'github',
                        content: 'Your GitHub account is now active and verified.'
                    },
                    {
                        title: 'Sign in to Endless Platform',
                        platform: 'endless',
                        content: 'Navigate to the Endless Platform and click "Sign in with GitHub". You\'ll be redirected to GitHub for OAuth authentication.',
                        details: 'You can only access Endless Platform after creating your GitHub account first.'
                    },
                    {
                        title: 'Endless Platform Access Granted',
                        platform: 'endless',
                        content: 'You\'re now signed into Endless Platform using your GitHub credentials.'
                    },
                    {
                        title: 'Download Explorer Bundle',
                        platform: 'endless',
                        content: 'Click "Explorer Program - Godot Bundle" button. The OS-specific installer (MSI for Windows, DMG for macOS) downloads automatically.'
                    },
                    {
                        title: 'Install Software Bundle',
                        platform: 'endless',
                        content: 'The installer runs automatically: Git installs silently (/SILENT argument), Godot extracts with pre-configured settings including GitHub connectivity plugins.',
                        details: 'Godot opens automatically with the Template project loaded.'
                    },
                    {
                        title: 'Receive Repository Invitation',
                        platform: 'email',
                        content: 'You receive an email: "teacher-username invited you to collaborate on team-alpha-godot-project".'
                    },
                    {
                        title: 'Accept Repository Invitation',
                        platform: 'github',
                        content: 'Click "View invitation" in email ‚Üí GitHub opens ‚Üí Yellow banner: "You\'ve been invited to collaborate" ‚Üí Click "Accept invitation".',
                        details: 'You now have Write access to your team repository.'
                    },
                    {
                        title: 'Choose Authentication Method',
                        platform: 'godot',
                        content: 'To download LFS files, you need to authenticate with GitHub. Choose your preferred method:',
                        type: 'choice',
                        choices: [
                            {
                                id: 'personal-token',
                                title: 'Personal Access Token (Manual)',
                                description: 'Generate token manually in GitHub settings'
                            },
                            {
                                id: 'github-cli',
                                title: 'GitHub CLI (Automated)',
                                description: 'Device code flow with automatic setup'
                            }
                        ]
                    }
                ],
                personalToken: [
                    {
                        title: 'Generate Personal Access Token',
                        platform: 'github',
                        content: 'Navigate to GitHub Settings ‚Üí Developer Settings ‚Üí Personal Access Tokens ‚Üí Generate new Token (classic)',
                        details: 'Note: "EP-Godot", Expiration: "No Expiration", Permissions: Check "repo" (includes all repository permissions)',
                        warning: 'CRITICAL: Copy the token immediately - it won\'t be displayed again!'
                    },
                    {
                        title: 'Token Generated',
                        platform: 'github',
                        content: 'Token created successfully. Keep the browser tab open until you use it in Godot.',
                        details: 'If you lose this token, you\'ll need to generate a new one.'
                    },
                    {
                        title: 'Configure Token in Godot',
                        platform: 'godot',
                        content: 'Open the "Endless Project Setup" plugin ‚Üí Paste your Personal Access Token in the authentication field.'
                    }
                ],
                githubCli: [
                    {
                        title: 'GitHub CLI Authentication Initiated',
                        platform: 'godot',
                        content: 'Godot triggers GitHub CLI with node-pty integration. A device registration code appears.'
                    },
                    {
                        title: 'Device Code Display',
                        platform: 'godot',
                        content: 'Pop-up shows 4√ó4 digit code with automatic clipboard copy. Click "Open Browser" to launch GitHub authentication page.'
                    },
                    {
                        title: 'Browser Authentication',
                        platform: 'github',
                        content: 'GitHub opens ‚Üí Log in (or confirm existing login) ‚Üí Paste the copied code ‚Üí Click "Authorize".'
                    },
                    {
                        title: 'CLI Authentication Complete',
                        platform: 'godot',
                        content: 'Close browser and return to Godot. Token is automatically retrieved and configured.'
                    }
                ],
                final: [
                    {
                        title: 'Download Team Project',
                        platform: 'godot',
                        content: 'Paste your team repository link into "Your project link" text box ‚Üí Click "Download Project".',
                        details: 'The complete project downloads with all LFS files using your authentication.'
                    },
                    {
                        title: 'Project Setup Complete',
                        platform: 'godot',
                        content: 'Your team project is now downloaded and ready for development!',
                        details: 'You can start coding, making commits, and collaborating with your team.',
                        complete: true
                    }
                ]
            },
            teacher: [
                {
                    title: 'Navigate to Master Repository',
                    platform: 'github',
                    content: 'Go to endless-studios/ep-godot-project repository on GitHub.'
                },
                {
                    title: 'Fork for First Team',
                    platform: 'github',
                    content: 'Click "Fork" button ‚Üí Select your teacher account ‚Üí Change name to "team-alpha-godot-project" ‚Üí Set visibility to "Private" ‚Üí Click "Create fork".'
                },
                {
                    title: 'Create Additional Team Forks',
                    platform: 'github',
                    content: 'Return to original repository and repeat forking process for each team: team-beta-godot-project, team-gamma-godot-project, etc.'
                },
                {
                    title: 'Invite Team Members',
                    platform: 'github',
                    content: 'For each team repository: Settings ‚Üí Manage access ‚Üí Invite a collaborator ‚Üí Enter username ‚Üí Set "Write" permissions ‚Üí Add to repository.',
                    details: 'Repeat for all team members. Each student receives an email invitation.'
                },
                {
                    title: 'Send Repository Links',
                    platform: 'email',
                    content: 'Email each team their specific repository link for easy access.',
                    complete: true
                }
            ]
        };
        
        // Godot Simulator State
        let godotCurrentStep = 'file-access';
        let godotPathTaken = ['Started'];
        let godotSimulationData = {
            user: 'Bob',
            file: 'PlayerController.gd',
            teammate1: 'Alice',
            teammate2: 'Charlie'
        };

        const godotWorkflowSteps = {
            'file-access': {
                title: 'Step 1: File Access Check',
                description: 'The system is checking the status of PlayerController.gd to determine if you can edit it...',
                choices: {
                    'available': {
                        text: 'üîó File is Available (No lock, no recent updates)',
                        next: 'edit-file',
                        pathLabel: 'File Available'
                    },
                    'has-updates': {
                        text: 'üìô File Has Recent Updates (Alice modified it 5 minutes ago)', 
                        next: 'handle-updates',
                        pathLabel: 'Has Updates'
                    },
                    'locked': {
                        text: 'üîí File is Currently Locked (Charlie is actively editing)',
                        next: 'handle-lock',
                        pathLabel: 'File Locked'
                    }
                }
            },
            
            'handle-updates': {
                title: 'Step 2: Handle Recent Updates',
                description: `‚ö†Ô∏è PlayerController.gd has been modified by ${godotSimulationData.teammate1} 5 minutes ago. You must get her changes first before editing.`,
                info: 'System Rule: You cannot work on files with recent updates until you sync them. No messaging needed - Alice has already completed her work.',
                choices: {
                    'get-updates': {
                        text: '‚¨áÔ∏è Get Alice\'s Updates First (Required)',
                        next: 'edit-file',
                        pathLabel: 'Got Updates'
                    }
                }
            },
            
            'handle-lock': {
                title: 'Step 2: Handle File Lock',
                description: `üîí PlayerController.gd is currently being edited by ${godotSimulationData.teammate2}. Lock expires in 8 minutes.`,
                info: 'System Rule: You cannot override locks. You must wait or coordinate.',
                choices: {
                    'wait-lock': {
                        text: '‚è≥ Wait for Charlie to Finish',
                        next: 'file-access',
                        pathLabel: 'Waited for Lock'
                    },
                    'message-locked': {
                        text: 'üí¨ Send Message to Charlie',
                        next: 'wait-response',
                        pathLabel: 'Messaged Locked User'
                    }
                }
            },
            
            'wait-response': {
                title: 'Step 3: Waiting for Teammate Response',
                description: 'You sent a message to your teammate. Waiting for their response...',
                info: 'In real workflow, this could take a few minutes to hours depending on teammate availability.',
                choices: {
                    'positive-response': {
                        text: '‚úÖ Teammate Responded Positively',
                        next: 'edit-file',
                        pathLabel: 'Got Permission'
                    },
                    'negative-response': {
                        text: '‚ùå Teammate Needs More Time',
                        next: 'wait-longer',
                        pathLabel: 'Need to Wait'
                    }
                }
            },
            
            'wait-longer': {
                title: 'Step 4: Extended Wait',
                description: 'Your teammate needs more time. You can work on other files or wait.',
                outcome: 'simulation-pause',
                choices: {
                    'try-again': {
                        text: 'üîÑ Check File Status Again Later',
                        next: 'file-access',
                        pathLabel: 'Tried Again Later'
                    }
                }
            },
            
            'edit-file': {
                title: 'Step 3: Editing File',
                description: `‚úèÔ∏è You are now editing PlayerController.gd. A 15-minute lock has been created automatically.`,
                info: 'The lock will extend indefinitely while you remain active in the file.',
                choices: {
                    'finish-editing': {
                        text: '‚úÖ Finished Making Changes',
                        next: 'share-changes',
                        pathLabel: 'Completed Edits'
                    }
                }
            },
            
            'share-changes': {
                title: 'Step 4: Share Changes',
                description: 'You want to share your changes with the team. System is checking for conflicts...',
                choices: {
                    'no-conflicts': {
                        text: '‚úÖ No Conflicts Detected',
                        next: 'push-success',
                        pathLabel: 'No Conflicts'
                    },
                    'potential-conflicts': {
                        text: '‚ö†Ô∏è Potential Conflicts Detected (MVP: Any change triggers notification)',
                        next: 'team-coordination',
                        pathLabel: 'Conflicts Detected'
                    }
                }
            },
            
            'push-success': {
                title: 'Step 5: Successful Push',
                description: 'üéâ Your changes have been successfully shared with the team!',
                outcome: 'success',
                info: 'Team status updated automatically. Your teammates will see the changes within 2-3 minutes.'
            },
            
            'team-coordination': {
                title: 'Step 5: Team Coordination Required',
                description: 'ü§ù System detected that Alice modified InventorySystem.gd recently. Team coordination is required.',
                info: 'MVP Rule: Any teammate modification triggers coordination process.',
                choices: {
                    'auto-approve': {
                        text: 'üëç Auto-Approve (Let system handle it)',
                        next: 'wait-team',
                        pathLabel: 'Auto-Approved'
                    },
                    'object': {
                        text: '‚úã I Object (Create discussion)',
                        next: 'create-discussion',
                        pathLabel: 'Objected'
                    }
                }
            },
            
            'wait-team': {
                title: 'Step 6: Waiting for Team Response',
                description: '‚è≥ Your team has 60 minutes to respond. Alice has been notified about the coordination request.',
                choices: {
                    'team-approves': {
                        text: '‚úÖ Team Approves (No objections received)',
                        next: 'auto-resolve',
                        pathLabel: 'Team Approved'
                    },
                    'team-objects': {
                        text: '‚úã Someone Objects',
                        next: 'create-discussion',
                        pathLabel: 'Team Objected'
                    },
                    'timeout': {
                        text: '‚è∞ Timeout (No response)',
                        next: 'auto-resolve',
                        pathLabel: 'Timeout Auto-Resolve'
                    }
                }
            },
            
            'auto-resolve': {
                title: 'Step 7: Auto-Resolution',
                description: 'üîÑ System is automatically resolving conflicts using push-order (first-to-push wins).',
                outcome: 'auto-resolved',
                info: 'All versions have been preserved with clear naming. Recovery tools are now available.'
            },
            
            'create-discussion': {
                title: 'Step 6: Simple Discussion Created',
                description: 'üí¨ A simple discussion interface has been created for coordination.',
                info: 'MVP Discussion: Basic messages and decision buttons only.',
                choices: {
                    'use-alice': {
                        text: 'üë§ Use Alice\'s Version',
                        next: 'manual-resolve',
                        pathLabel: 'Chose Alice\'s Version'
                    },
                    'use-mine': {
                        text: 'üë§ Use My Version',
                        next: 'manual-resolve',
                        pathLabel: 'Chose My Version'
                    },
                    'combine': {
                        text: 'üîß Combine Manually',
                        next: 'manual-combine',
                        pathLabel: 'Manual Combination'
                    }
                }
            },
            
            'manual-resolve': {
                title: 'Step 7: Manual Resolution',
                description: '‚úÖ Resolution completed based on team decision.',
                outcome: 'manual-resolved',
                info: 'All versions preserved as backups. Team has been notified of the resolution.'
            },
            
            'manual-combine': {
                title: 'Step 7: Manual Combination',
                description: 'üîß Team will work together outside the system to combine changes.',
                outcome: 'manual-combination',
                info: 'All versions preserved. Team can use external tools to merge changes, then upload the result.'
            }
        };
        
        // Navigation Functions
        function showMainMenu() {
            document.getElementById('mainMenu').style.display = 'block';
            document.getElementById('githubSimulator').style.display = 'none';
            document.getElementById('godotSimulator').style.display = 'none';
            document.getElementById('backBtn').style.display = 'none';
            currentView = 'main';
        }
        
        function showGitHubSimulator() {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('githubSimulator').style.display = 'block';
            document.getElementById('godotSimulator').style.display = 'none';
            document.getElementById('backBtn').style.display = 'block';
            currentView = 'github';
            resetGitHubSimulator();
        }
        
        function showGodotSimulator() {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('githubSimulator').style.display = 'none';
            document.getElementById('godotSimulator').style.display = 'block';
            document.getElementById('backBtn').style.display = 'block';
            currentView = 'godot';
            resetGodotSimulation();
        }
        
        // GitHub Simulator Functions
        function resetGitHubSimulator() {
            githubState = {
                role: '',
                currentStep: 0,
                authMethod: '',
                workflow: []
            };
            document.getElementById('githubRoleSelection').style.display = 'grid';
            document.getElementById('githubWorkflow').style.display = 'none';
        }
        
        function startGitHubWorkflow(role) {
            githubState.role = role;
            githubState.currentStep = 0;
            githubState.workflow = role === 'student' ? githubWorkflows.student.base : githubWorkflows.teacher;
            
            document.getElementById('githubRoleSelection').style.display = 'none';
            document.getElementById('githubWorkflow').style.display = 'block';
            
            renderGitHubStep();
        }
        
        function buildStudentWorkflow() {
            let workflow = [...githubWorkflows.student.base];
            
            if (githubState.authMethod === 'personal-token') {
                workflow = [...workflow, ...githubWorkflows.student.personalToken, ...githubWorkflows.student.final];
            } else if (githubState.authMethod === 'github-cli') {
                workflow = [...workflow, ...githubWorkflows.student.githubCli, ...githubWorkflows.student.final];
            }
            
            return workflow;
        }
        
        function renderGitHubStep() {
            if (githubState.role === 'student' && githubState.authMethod) {
                githubState.workflow = buildStudentWorkflow();
            }
            
            const step = githubState.workflow[githubState.currentStep];
            if (!step) return;
            
            const progress = ((githubState.currentStep + 1) / githubState.workflow.length) * 100;
            document.getElementById('githubProgress').style.width = progress + '%';
            document.getElementById('githubStepInfo').textContent = 
                `Step ${githubState.currentStep + 1} of ${githubState.workflow.length}`;
            
            let stepHtml = `
                <div class="platform-badge ${step.platform}">${getPlatformIcon(step.platform)} ${getPlatformLabel(step.platform)}</div>
                <h3 class="step-title">${step.title}</h3>
                <div class="step-content">${step.content}</div>
            `;
            
            if (step.details) {
                stepHtml += `<div class="step-details">${step.details}</div>`;
            }
            
            if (step.warning) {
                stepHtml += `<div class="step-warning">‚ö†Ô∏è ${step.warning}</div>`;
            }
            
            if (step.type === 'choice') {
                stepHtml += '<div class="choices-grid">';
                step.choices.forEach(choice => {
                    stepHtml += `
                        <button class="choice-btn" onclick="makeGitHubChoice('${choice.id}')">
                            <div class="choice-header">
                                ${choice.id === 'personal-token' ? 'üîë' : 'üíª'} ${choice.title}
                            </div>
                            <div class="choice-desc">${choice.description}</div>
                        </button>
                    `;
                });
                stepHtml += '</div>';
            } else if (!step.complete) {
                stepHtml += '<button class="next-btn" onclick="nextGitHubStep()">Next ‚Üí</button>';
            } else {
                stepHtml += '<button class="complete-btn" onclick="resetGitHubSimulator()">Start New Simulation</button>';
            }
            
            document.getElementById('githubCurrentStep').innerHTML = stepHtml;
            
            // Update state display
            if (githubState.authMethod) {
                document.getElementById('githubStateDisplay').style.display = 'block';
                document.getElementById('githubStateContent').innerHTML = `
                    <div class="state-item">‚úì Authentication Method: ${githubState.authMethod === 'personal-token' ? 'Personal Access Token' : 'GitHub CLI'}</div>
                    <div class="state-item">Total Steps in Current Path: ${githubState.workflow.length}</div>
                `;
            }
        }
        
        function makeGitHubChoice(choiceId) {
            if (choiceId === 'personal-token' || choiceId === 'github-cli') {
                githubState.authMethod = choiceId;
            }
            
            setTimeout(() => {
                githubState.currentStep++;
                renderGitHubStep();
            }, 500);
        }
        
        function nextGitHubStep() {
            githubState.currentStep++;
            renderGitHubStep();
        }
        
        function getPlatformIcon(platform) {
            const icons = {
                github: 'üêô',
                godot: 'üéÆ',
                endless: 'üì±',
                email: 'üìß'
            };
            return icons[platform] || 'üîß';
        }
        
        function getPlatformLabel(platform) {
            const labels = {
                github: 'GitHub Web',
                godot: 'Godot',
                endless: 'Endless Platform',
                email: 'Email'
            };
            return labels[platform] || platform;
        }
        
        // Godot Simulator Functions
        function makeGodotChoice(choiceKey) {
            const step = godotWorkflowSteps[godotCurrentStep];
            const choice = step.choices[choiceKey];
            
            godotPathTaken.push(choice.pathLabel);
            updateGodotPathDisplay();
            
            if (choice.next) {
                godotCurrentStep = choice.next;
                renderGodotStep();
            }
        }

        function renderGodotStep() {
            const step = godotWorkflowSteps[godotCurrentStep];
            const container = document.getElementById('current-step-container');
            
            // Handle outcomes
            if (step.outcome) {
                showGodotOutcome(step);
                return;
            }
            
            // Add info box if exists
            let infoHtml = '';
            if (step.info) {
                infoHtml = `<div class="info-box"><strong>Info:</strong> ${step.info}</div>`;
            }
            
            // Add choices
            let choicesHtml = '';
            for (const [key, choice] of Object.entries(step.choices)) {
                choicesHtml += `<button class="choice-btn-godot" onclick="makeGodotChoice('${key}')">${choice.text}</button>`;
            }
            
            // Update the entire container content
            container.innerHTML = `
                <div class="current-step-godot">
                    <h3 id="step-title">${step.title}</h3>
                    <p id="step-description">${step.description}</p>
                    ${infoHtml}
                    <div class="choices-godot" id="choices-container">
                        ${choicesHtml}
                    </div>
                </div>
            `;
        }

        function showGodotOutcome(step) {
            const outcomeContainer = document.getElementById('outcome-container');
            const currentStepContainer = document.getElementById('current-step-container');
            const resetButton = document.getElementById('reset-button');
            
            let outcomeClass = 'success-box';
            let outcomeIcon = 'üéâ';
            let outcomeTitle = 'Workflow Complete!';
            
            switch(step.outcome) {
                case 'success':
                    outcomeTitle = 'Success! Changes Shared Successfully';
                    break;
                case 'auto-resolved':
                    outcomeTitle = 'Auto-Resolution Complete';
                    outcomeIcon = 'üîÑ';
                    break;
                case 'manual-resolved':
                    outcomeTitle = 'Manual Resolution Complete';
                    outcomeIcon = 'üë•';
                    break;
                case 'manual-combination':
                    outcomeTitle = 'Manual Combination Required';
                    outcomeIcon = 'üîß';
                    outcomeClass = 'info-box';
                    break;
                case 'simulation-pause':
                    outcomeTitle = 'Simulation Paused - Waiting Period';
                    outcomeIcon = '‚∏∞';
                    outcomeClass = 'warning-box';
                    break;
            }
            
            outcomeContainer.innerHTML = `
                <div class="outcome">
                    <h3>${outcomeIcon} ${outcomeTitle}</h3>
                    <p>${step.description}</p>
                    ${step.info ? `<div class="${outcomeClass}"><strong>Result:</strong> ${step.info}</div>` : ''}
                </div>
            `;
            
            currentStepContainer.style.display = 'none';
            resetButton.style.display = 'block';
        }

        function updateGodotPathDisplay() {
            const pathDisplay = document.getElementById('path-display');
            pathDisplay.innerHTML = godotPathTaken.map(step => 
                `<span class="path-step">${step}</span>`
            ).join(' ‚Üí ');
        }

        function resetGodotSimulation() {
            godotCurrentStep = 'file-access';
            godotPathTaken = ['Started'];
            
            document.getElementById('outcome-container').innerHTML = '';
            document.getElementById('current-step-container').style.display = 'block';
            document.getElementById('reset-button').style.display = 'none';
            
            updateGodotPathDisplay();
            renderGodotStep();
        }
        
        // Initialize
        showMainMenu();
    </script>
</body>
</html>