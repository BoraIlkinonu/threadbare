<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Godot Collaborative Development - Workflow Simulator</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        
        .scenario-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .current-step {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border: none;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }
        
        .choice-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .choice-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .path-tracker {
            background: #e8f4f8;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #1abc9c;
        }
        
        .path-step {
            background: #1abc9c;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            margin: 2px;
            display: inline-block;
        }
        
        .outcome {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        
        .reset-btn:hover {
            background: #c0392b;
        }
        
        .info-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            color: #856404;
        }
        
        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            color: #155724;
        }
        
        .warning-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Godot Collaborative Development Workflow Simulator</h1>
        
        <div class="info-box">
            <h4>üéØ Implementation Note</h4>
            <p><strong>This simulator demonstrates the MVP implementation:</strong> Universal file handling where all file types (.gd, .tscn, .png, .ogg) are treated equally with simple conflict detection and basic preservation. The Full Feature implementation will add file-type-specific intelligence, visual comparison tools, and advanced collaboration features.</p>
        </div>
        
        <div class="scenario-section">
            <h3>üìù Current Scenario</h3>
            <p><strong>Team:</strong> Alice, Bob, and Charlie working on a 2D platformer game</p>
            <p><strong>Context:</strong> You are <span id="current-user">Bob</span>, and you want to work on <span id="current-file">PlayerController.gd</span></p>
        </div>
        
        <div class="path-tracker">
            <h4>üõ§Ô∏è Your Path Through the Workflow:</h4>
            <div id="path-display">
                <span class="path-step">Started</span>
            </div>
        </div>
        
        <div id="current-step-container">
            <div class="current-step">
                <h3 id="step-title">Step 1: File Access Check</h3>
                <p id="step-description">The system is checking the status of PlayerController.gd to determine if you can edit it...</p>
                
                <div class="info-box">
                    <strong>System Status:</strong> Checking lock status and recent updates...
                </div>
                
                <div class="choices" id="choices-container">
                    <button class="choice-btn" onclick="makeChoice('available')">
                        üìó File is Available (No lock, no recent updates)
                    </button>
                    <button class="choice-btn" onclick="makeChoice('has-updates')">
                        üìô File Has Recent Updates (Alice modified it 5 minutes ago)
                    </button>
                    <button class="choice-btn" onclick="makeChoice('locked')">
                        üìï File is Currently Locked (Charlie is actively editing)
                    </button>
                </div>
            </div>
        </div>
        
        <div id="outcome-container"></div>
        
        <button class="reset-btn" onclick="resetSimulation()" style="display: none;" id="reset-button">
            üîÑ Start New Simulation
        </button>
    </div>

    <script>
        let currentStep = 'file-access';
        let pathTaken = ['Started'];
        let simulationData = {
            user: 'Bob',
            file: 'PlayerController.gd',
            teammate1: 'Alice',
            teammate2: 'Charlie'
        };

        const workflowSteps = {
            'file-access': {
                title: 'Step 1: File Access Check',
                description: 'The system is checking the status of PlayerController.gd to determine if you can edit it...',
                choices: {
                    'available': {
                        text: 'üìó File is Available (No lock, no recent updates)',
                        next: 'edit-file',
                        pathLabel: 'File Available'
                    },
                    'has-updates': {
                        text: 'üìô File Has Recent Updates (Alice modified it 5 minutes ago)', 
                        next: 'handle-updates',
                        pathLabel: 'Has Updates'
                    },
                    'locked': {
                        text: 'üìï File is Currently Locked (Charlie is actively editing)',
                        next: 'handle-lock',
                        pathLabel: 'File Locked'
                    }
                }
            },
            
            'handle-updates': {
                title: 'Step 2: Handle Recent Updates',
                description: `‚ö†Ô∏è PlayerController.gd has been modified by ${simulationData.teammate1} 5 minutes ago. You must get her changes first before editing.`,
                info: 'System Rule: You cannot work on files with recent updates until you sync them. No messaging needed - Alice has already completed her work.',
                choices: {
                    'get-updates': {
                        text: '‚¨áÔ∏è Get Alice\'s Updates First (Required)',
                        next: 'edit-file',
                        pathLabel: 'Got Updates'
                    }
                }
            },
            
            'handle-lock': {
                title: 'Step 2: Handle File Lock',
                description: `üîí PlayerController.gd is currently being edited by ${simulationData.teammate2}. Lock expires in 8 minutes.`,
                info: 'System Rule: You cannot override locks. You must wait or coordinate.',
                choices: {
                    'wait-lock': {
                        text: '‚è≥ Wait for Charlie to Finish',
                        next: 'file-access',
                        pathLabel: 'Waited for Lock'
                    },
                    'message-locked': {
                        text: 'üí¨ Send Message to Charlie',
                        next: 'wait-response',
                        pathLabel: 'Messaged Locked User'
                    }
                }
            },
            
            'wait-response': {
                title: 'Step 3: Waiting for Teammate Response',
                description: 'You sent a message to your teammate. Waiting for their response...',
                info: 'In real workflow, this could take a few minutes to hours depending on teammate availability.',
                choices: {
                    'positive-response': {
                        text: '‚úÖ Teammate Responded Positively',
                        next: 'edit-file',
                        pathLabel: 'Got Permission'
                    },
                    'negative-response': {
                        text: '‚ùå Teammate Needs More Time',
                        next: 'wait-longer',
                        pathLabel: 'Need to Wait'
                    }
                }
            },
            
            'wait-longer': {
                title: 'Step 4: Extended Wait',
                description: 'Your teammate needs more time. You can work on other files or wait.',
                outcome: 'simulation-pause',
                choices: {
                    'try-again': {
                        text: 'üîÑ Check File Status Again Later',
                        next: 'file-access',
                        pathLabel: 'Tried Again Later'
                    }
                }
            },
            
            'edit-file': {
                title: 'Step 3: Editing File',
                description: `‚úèÔ∏è You are now editing PlayerController.gd. A 15-minute lock has been created automatically.`,
                info: 'The lock will extend indefinitely while you remain active in the file.',
                choices: {
                    'finish-editing': {
                        text: '‚úÖ Finished Making Changes',
                        next: 'share-changes',
                        pathLabel: 'Completed Edits'
                    }
                }
            },
            
            'share-changes': {
                title: 'Step 4: Share Changes',
                description: 'You want to share your changes with the team. System is checking for conflicts...',
                choices: {
                    'no-conflicts': {
                        text: '‚úÖ No Conflicts Detected',
                        next: 'push-success',
                        pathLabel: 'No Conflicts'
                    },
                    'potential-conflicts': {
                        text: '‚ö†Ô∏è Potential Conflicts Detected (MVP: Any change triggers notification)',
                        next: 'team-coordination',
                        pathLabel: 'Conflicts Detected'
                    }
                }
            },
            
            'push-success': {
                title: 'Step 5: Successful Push',
                description: 'üéâ Your changes have been successfully shared with the team!',
                outcome: 'success',
                info: 'Team status updated automatically. Your teammates will see the changes within 2-3 minutes.'
            },
            
            'team-coordination': {
                title: 'Step 5: Team Coordination Required',
                description: 'ü§ù System detected that Alice modified InventorySystem.gd recently. Team coordination is required.',
                info: 'MVP Rule: Any teammate modification triggers coordination process.',
                choices: {
                    'auto-approve': {
                        text: 'üëç Auto-Approve (Let system handle it)',
                        next: 'wait-team',
                        pathLabel: 'Auto-Approved'
                    },
                    'object': {
                        text: '‚úã I Object (Create discussion)',
                        next: 'create-discussion',
                        pathLabel: 'Objected'
                    }
                }
            },
            
            'wait-team': {
                title: 'Step 6: Waiting for Team Response',
                description: '‚è≥ Your team has 60 minutes to respond. Alice has been notified about the coordination request.',
                choices: {
                    'team-approves': {
                        text: '‚úÖ Team Approves (No objections received)',
                        next: 'auto-resolve',
                        pathLabel: 'Team Approved'
                    },
                    'team-objects': {
                        text: '‚úã Someone Objects',
                        next: 'create-discussion',
                        pathLabel: 'Team Objected'
                    },
                    'timeout': {
                        text: '‚è∞ Timeout (No response)',
                        next: 'auto-resolve',
                        pathLabel: 'Timeout Auto-Resolve'
                    }
                }
            },
            
            'auto-resolve': {
                title: 'Step 7: Auto-Resolution',
                description: 'üîÑ System is automatically resolving conflicts using push-order (first-to-push wins).',
                outcome: 'auto-resolved',
                info: 'All versions have been preserved with clear naming. Recovery tools are now available.'
            },
            
            'create-discussion': {
                title: 'Step 6: Simple Discussion Created',
                description: 'üí¨ A simple discussion interface has been created for coordination.',
                info: 'MVP Discussion: Basic messages and decision buttons only.',
                choices: {
                    'use-alice': {
                        text: 'üë§ Use Alice\'s Version',
                        next: 'manual-resolve',
                        pathLabel: 'Chose Alice\'s Version'
                    },
                    'use-mine': {
                        text: 'üë§ Use My Version',
                        next: 'manual-resolve',
                        pathLabel: 'Chose My Version'
                    },
                    'combine': {
                        text: 'üîß Combine Manually',
                        next: 'manual-combine',
                        pathLabel: 'Manual Combination'
                    }
                }
            },
            
            'manual-resolve': {
                title: 'Step 7: Manual Resolution',
                description: '‚úÖ Resolution completed based on team decision.',
                outcome: 'manual-resolved',
                info: 'All versions preserved as backups. Team has been notified of the resolution.'
            },
            
            'manual-combine': {
                title: 'Step 7: Manual Combination',
                description: 'üîß Team will work together outside the system to combine changes.',
                outcome: 'manual-combination',
                info: 'All versions preserved. Team can use external tools to merge changes, then upload the result.'
            }
        };

        function makeChoice(choiceKey) {
            const step = workflowSteps[currentStep];
            const choice = step.choices[choiceKey];
            
            pathTaken.push(choice.pathLabel);
            updatePathDisplay();
            
            if (choice.next) {
                currentStep = choice.next;
                renderStep();
            }
        }

        function renderStep() {
            const step = workflowSteps[currentStep];
            const container = document.getElementById('current-step-container');
            
            // Handle outcomes
            if (step.outcome) {
                showOutcome(step);
                return;
            }
            
            // Add info box if exists
            let infoHtml = '';
            if (step.info) {
                infoHtml = `<div class="info-box"><strong>Info:</strong> ${step.info}</div>`;
            }
            
            // Add choices
            let choicesHtml = '';
            for (const [key, choice] of Object.entries(step.choices)) {
                choicesHtml += `<button class="choice-btn" onclick="makeChoice('${key}')">${choice.text}</button>`;
            }
            
            // Update the entire container content
            container.innerHTML = `
                <div class="current-step">
                    <h3 id="step-title">${step.title}</h3>
                    <p id="step-description">${step.description}</p>
                    ${infoHtml}
                    <div class="choices" id="choices-container">
                        ${choicesHtml}
                    </div>
                </div>
            `;
        }

        function showOutcome(step) {
            const outcomeContainer = document.getElementById('outcome-container');
            const currentStepContainer = document.getElementById('current-step-container');
            const resetButton = document.getElementById('reset-button');
            
            let outcomeClass = 'success-box';
            let outcomeIcon = 'üéâ';
            let outcomeTitle = 'Workflow Complete!';
            
            switch(step.outcome) {
                case 'success':
                    outcomeTitle = 'Success! Changes Shared Successfully';
                    break;
                case 'auto-resolved':
                    outcomeTitle = 'Auto-Resolution Complete';
                    outcomeIcon = 'üîÑ';
                    break;
                case 'manual-resolved':
                    outcomeTitle = 'Manual Resolution Complete';
                    outcomeIcon = 'üë•';
                    break;
                case 'manual-combination':
                    outcomeTitle = 'Manual Combination Required';
                    outcomeIcon = 'üîß';
                    outcomeClass = 'info-box';
                    break;
                case 'simulation-pause':
                    outcomeTitle = 'Simulation Paused - Waiting Period';
                    outcomeIcon = '‚è∏Ô∏è';
                    outcomeClass = 'warning-box';
                    break;
            }
            
            outcomeContainer.innerHTML = `
                <div class="outcome">
                    <h3>${outcomeIcon} ${outcomeTitle}</h3>
                    <p>${step.description}</p>
                    ${step.info ? `<div class="${outcomeClass}"><strong>Result:</strong> ${step.info}</div>` : ''}
                </div>
            `;
            
            currentStepContainer.style.display = 'none';
            resetButton.style.display = 'block';
        }

        function updatePathDisplay() {
            const pathDisplay = document.getElementById('path-display');
            pathDisplay.innerHTML = pathTaken.map(step => 
                `<span class="path-step">${step}</span>`
            ).join(' ‚Üí ');
        }

        function resetSimulation() {
            currentStep = 'file-access';
            pathTaken = ['Started'];
            
            document.getElementById('outcome-container').innerHTML = '';
            document.getElementById('current-step-container').style.display = 'block';
            document.getElementById('reset-button').style.display = 'none';
            
            updatePathDisplay();
            renderStep();
        }

        // Initialize the simulation
        renderStep();
    </script>
</body>
</html>